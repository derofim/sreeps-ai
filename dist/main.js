var cachedModules=[];cachedModules[1341]={exports:{}},function(e,o){"use strict";function r(e){return e?(console.log(e),Memory.lastMessage=e,!0):!1}function t(){return arguments.toJSON=[].slice,r(JSON.stringify(arguments))}function s(e){var o=Memory.lastMessage||"";return o==e?!1:(r(e),!0)}function a(e,o){Memory.messages=Memory.messages||{};for(var t in Memory.messages)Game.time-Memory.messages[t].time>1024&&delete Memory.messages[t];var s=e.substring(0,30);Memory.messages[s]=Memory.messages[s]||{time:Game.time};var a=Game.time-Memory.messages[s].time;return o>a&&0!==a?!1:(r(e),Memory.messages[s]={time:Game.time},!0)}function c(e,o){var r=0;for(var t in o){var s=o[t];switch(s){case MOVE:r+=50;break;case WORK:r+=100;break;case CARRY:r+=50;break;case ATTACK:r+=80;break;case RANGED_ATTACK:r+=150;break;case HEAL:r+=250;break;case CLAIM:r+=600;break;case TOUGH:r+=10}}return r}function n(e){for(var o in Game.creeps)void 0!==e&&Game.creeps[o].memory.role!=e||Game.creeps[o].suicide()}function i(e,o,r,t){var s=r-e,a=t-o;return s*s+a*a}function u(e){return Memory.rooms[e].spawns}function l(e,o,r,t){var s,a,c,n,u=null,l=t||{};for(var d in r)if(r[d]&&(s=r[d],n=Game.getObjectById(s.id)||s,a=i(e,o,s.x,s.y),c>a||!c)){if(l.notFull&&n.energy>=n.energyCapacity)continue;if(l.notEmpty&&n.energy<=0)continue;c=a,u=s}return u}e.exports={log:r,logOnce:s,logDelay:a,killByRole:n,spawnCost:c,absTo:i,absClosest:l,getRoomSpawns:u,logJSON:t}}.call(this,cachedModules[1341],cachedModules[1341].exports),cachedModules[856]={exports:{}},function(e,o){"use strict";function r(){return void 0!==Memory.init?!0:(Memory.init=!0,Memory.counters={CREATED:0,ALIVE:0},!1)}function t(){}function s(){t();for(var e in Game.rooms)a(Game.rooms[e])}function a(e){y(e),c(e)}function c(e){if(!e.memory.source_path){e.memory.source_path=e.memory.source_path||{};var o,r,t,s,a,c,n,i;e.memory.uniqueflow={};for(o in Game.spawns){t=x(e);for(r in t)s=Game.getObjectById(t[r].id),a=p(e,s.pos,Game.spawns[o].pos),a&&(c=m(a,s.room.name),i=_.size(_.intersection(Object.keys(c.backward),Object.keys(e.memory.uniqueflow))),n=d(s.pos,c.backward[f(s)]),e.memory.source_path[M(Game.spawns[o],s)]={flow:c.backward,flowSize:_.size(c.forward)-i-1,maxFlowSize:_.size(c.forward)-1,startPos:s.pos,startID:s.id,toID:Game.spawns[o].id,flowStartPos:n},i=_.size(_.intersection(Object.keys(c.forward),Object.keys(e.memory.uniqueflow))),n=d(Game.spawns[o].pos,c.forward[f(Game.spawns[o])]),e.memory.source_path[M(s,Game.spawns[o])]={flow:c.forward,flowSize:_.size(c.forward)-i-1,maxFlowSize:_.size(c.forward)-1,startPos:Game.spawns[o].pos,startID:Game.spawns[o].id,toID:s.id,flowStartPos:n},_.extend(e.memory.uniqueflow,c.forward),delete e.memory.uniqueflow[f(Game.spawns[o])])}}}function n(e,o,r){var t=i(o,r).flow,s=h(e.x,e.y),a=t[s];return a?a:ERR_NOT_IN_POS}function i(e,o){var r=Game.rooms[e].memory.source_path[o];return r?r:ERR_NO_FLOW}function u(e){return(e+3)%8+1}function l(e){var o={x:0,y:0};return e==TOP?--o.y:e==BOTTOM?++o.y:e==RIGHT?++o.x:e==LEFT?--o.x:e==TOP_RIGHT?(o.y--,o.x++):e==TOP_LEFT?(o.y--,o.x--):e==BOTTOM_RIGHT?(o.y++,o.x++):e==BOTTOM_LEFT&&(o.y++,o.x--),o}function d(e,o){var r=l(o);return{x:e.x+r.x,y:e.y+r.y}}function m(e,o){var r={forward:{},backward:{}};for(var t in e){var s=u(e[t].direction);r.forward[h(e[t].x,e[t].y)]=s;var a=d(e[t],s),c=e[t].direction;r.backward[h(a.x,a.y)]=c}return r}function p(e,o,r){if(r&&e){var t=e.findPath(o,r,{ignoreCreeps:!0,ignoreDestructibleStructures:!0,ignoreRoads:!0});if(t.length>15)return null;for(var s in t)var a=e.createConstructionSite(t[s].x,t[s].y,STRUCTURE_ROAD);return t}}function y(e){if(!e.memory.source_data){e.memory.source_data=e.memory.source_data||{};var o=e.find(FIND_SOURCES);E.log("Found "+_.size(o)+" sources in room "+e.name);var r;for(var t in o)r=o[t],e.memory.source_data[f(r)]={id:r.id,x:r.pos.x,y:r.pos.y,emptyTiles:r.pos.countEmptyTilesAround(),energyCapacity:r.energyCapacity}}}function f(e){return h(e.pos.x,e.pos.y)}function h(e,o){return e+"_"+o}function M(e,o){return f(e)+"_"+f(o)}function R(e){var o=Game.creeps[e];return void 0===o||o.spawning===!1&&void 0===o.memory.role?(delete Memory.creeps[e],!0):!1}function x(e){return e.memory.source_data||{}}function g(){delete Memory.spawns,delete Memory.rooms,delete Memory.counters,delete Memory.lastMessage,delete Memory.lastCacheTime,delete Memory.init}var E=cachedModules[1341].exports;e.exports={init:r,recycleCreep:R,initialized:Memory.init,stepGlobal:s,getRoomSources:x,getFlowDir:n,getMemoryKey:f,getMemoryKeyByPos:h,getFlow:i,getCompoundKey:M,nextTile:d,reverseDir:u,restart:g}}.call(this,cachedModules[856],cachedModules[856].exports),cachedModules[1968]={exports:{}},function(e,o){"use strict";function r(e,o,r,t){return"string"==typeof Game.spawns[t].createCreep(e,o,r)}function t(e){var o=e||{memory:!0};return o.memory&&s.restart(),!0}var s=(cachedModules[1341].exports,cachedModules[856].exports);e.exports={spawnCreep:r,restart:t}}.call(this,cachedModules[1968],cachedModules[1968].exports),cachedModules[6031]={exports:{}},function(e,o){"use strict";var r=cachedModules[1968].exports;e.exports=function(){global._=require("lodash"),global.AI={commands:{spawnCreep:r.spawnCreep,restart:r.restart}},global.AI_VERSION="0.0.1",global.ROLE_BASE=0,global.ROLE_DUMMY=1,global.ROLE_HARVESTER=2,global.ROLE_BUILDER=3,global.ROLE_GUARD=4,global.ROLE_RANGED=5,global.ROLE_HELPER=6,global.ROLE_SCOUT=7,global.ERR_NO_FLOW=-1,global.ERR_NOT_IN_POS=-2}()}.call(this,cachedModules[6031],cachedModules[6031].exports),cachedModules[6644]={exports:{}},function(e,o){"use strict";function r(e){console.log("No action set for "+e.name)}function t(e){console.log("No reset action set for "+e.name)}e.exports={role:"default",run:r,reset:t}}.call(this,cachedModules[6644],cachedModules[6644].exports),cachedModules[7202]={exports:{}},function(e,o){"use strict";function r(e){if(!e)return!1;var o=(e.carry.energy,e.carryCapacity,e.pos.findClosestByPath(FIND_FLAGS,{filter:function(e){return e.color==COLOR_GREEN?!0:null}}));return e.moveAt(o),!0}var t=cachedModules[6644].exports,s=Object.create(t);s.run=r,s.role="dummy",e.exports=s}.call(this,cachedModules[7202],cachedModules[7202].exports),cachedModules[7985]={exports:{}},function(e,o){"use strict";function r(){return void 0!==l?l:(l=!0,t(),Memory.lastCacheTime=Memory.lastCacheTime||Game.time,Game.time-Memory.lastCacheTime,void(Memory.lastCacheTime=Game.time))}function t(){var e,o,r,t;for(var s in Game.spawns)t=Game.spawns[s],o=a(Game.spawns[s]),e=t.room.name,r=d.rooms[e]||{},r.spawns=r.spawns||{},r.spawns[o]={id:t.id,x:t.pos.x,y:t.pos.y,my:t.my,name:t.name},d.rooms[e]=r,t.room.memory.spawns=t.room.memory.spawns||{},t.room.memory.spawns[o]=r.spawns[o];return d.rooms}function s(e){return d.rooms[e]}function a(e){return e.pos.x+"_"+e.pos.y}function c(){}function n(e){c(),r();var o=e||{};return o}function i(){}function u(){i()}var l,d=(cachedModules[1341].exports,{rooms:{}});e.exports={getRooms:t,getRoomCache:s,step:n,stepGlobal:u}}.call(this,cachedModules[7985],cachedModules[7985].exports),cachedModules[7421]={exports:{}},function(e,o){"use strict";function r(e){return e.memory.created?!0:(e.memory.created=!0,u(e,!0),l(e,!0),c(e,f),!1)}function t(e){return r(e)?!e||e.spawning?!1:(e.carry.energy<e.carryCapacity?s(e):a(e),!0):!1}function s(e){var o=null,r=u(e,!0);e.memory.target_id=r.id,o=Game.getObjectById(e.memory.spawn_id),e.harvest(r)==ERR_NOT_IN_RANGE&&n(e,o,r)}function a(e){var o=null,r=l(e,!0);e.memory.target_id=r.id,o=Game.getObjectById(e.memory.source_id),e.transfer(r,RESOURCE_ENERGY)==ERR_NOT_IN_RANGE&&n(e,o,r)}function c(e,o){e.memory.taskQue=e.memory.taskQue||[],e.memory.taskQue.push(o)}function n(e,o,r){if(!(e.fatigue>0&&e.carry.energy<=0)){var t=m.getCompoundKey(r,o),s=m.getFlow(e.room.name,t),a=m.getFlowDir(e.pos,e.room.name,t);a==ERR_NOT_IN_POS?(e.moveTo(s.flowStartPos.x,s.flowStartPos.y),console.log(s.flowSize+" moveTo!"+s.flowStartPos.x+" "+s.flowStartPos.y)):i(e,o,r,a)}}function i(e,o,r,t){var s,a,c,n=m.nextTile(e.pos,t),i=e.room.lookForAt("creep",n.x,n.y);for(var u in i)i[u].spawning||i[u].memory.role!=ROLE_HARVESTER||(i[u].getActiveBodyparts(WORK)>e.getActiveBodyparts(WORK)&&(s=i[u]),i[u].getActiveBodyparts(WORK)<e.getActiveBodyparts(WORK)&&(a=i[u]),i[u].getActiveBodyparts(CARRY)>0&&(c=i[u]));e.memory.target_id==e.memory.source_id?a?(p.log("weakerCreep"+a.name),e.moveBy(t),a.moveBy(m.reverseDir(t))):e.moveBy(t):c?e.transfer(c,RESOURCE_ENERGY)||p.log("Cant transfer energy at "+JSON.stringify(n)+" to creep "+c.name):e.moveBy(t)}function u(e,o){if(e.memory.source_id&&Game.getObjectById(e.memory.source_id))return Game.getObjectById(e.memory.source_id);var r=m.getRoomSources(e.room),t=p.absClosest(e.pos.x,e.pos.y,r);return t?(o&&(e.memory.source_id=t.id),Game.getObjectById(t.id)):null}function l(e,o){if(e.memory.spawn_id&&Game.getObjectById(e.memory.spawn_id))return Game.getObjectById(e.memory.spawn_id);var r=p.getRoomSpawns(e.room.name),t=p.absClosest(e.pos.x,e.pos.y,r,{notFull:!0});return t?(o&&(e.memory.spawn_id=t.id),Game.getObjectById(t.id)):null}var d=cachedModules[6644].exports,m=cachedModules[856].exports,p=(cachedModules[7985].exports,cachedModules[1341].exports),y=Object.create(d);y.run=t,y.role=ROLE_HARVESTER,e.exports=y;var f=1}.call(this,cachedModules[7421],cachedModules[7421].exports),cachedModules[2672]={exports:{}},function(e,o){"use strict";function r(e){var o=t(e);o.run(e)}function t(e){switch(e.memory.role){case ROLE_DUMMY:return a;case ROLE_HARVESTER:return c;case ROLE_BUILDER:return a;case ROLE_GUARD:return a;case ROLE_RANGED:return a;case ROLE_HELPER:return a;case ROLE_SCOUT:return a;default:return s}}var s=cachedModules[6644].exports,a=cachedModules[7202].exports,c=cachedModules[7421].exports;e.exports={run:r}}.call(this,cachedModules[2672],cachedModules[2672].exports),cachedModules[6988]={exports:{}},function(e,o){"use strict";var r=cachedModules[2672].exports;Creep.prototype.moveAt=function(e){return this.fatigue>0?this:(this.moveTo(e),this)},Creep.prototype.moveBy=function(e){return this.fatigue>0?this:(this.move(e),this)},Creep.prototype.action=function(){r.run(this)}}.call(this,cachedModules[6988],cachedModules[6988].exports),cachedModules[6860]={exports:{}},function(e,o){}.call(this,cachedModules[6860],cachedModules[6860].exports),cachedModules[3837]={exports:{}},function(e,o){"use strict";function r(e,o){if(!Array.isArray(e))return void 0===o?!0:o;for(var r=0;r<e.length;r++){if("terrain"===e[r].type&&("wall"===e[r].terrain||"lava"===e[r].terrain))return!0;if("structure"===e[r].type)switch(e[r].structure.structureType){case STRUCTURE_CONTROLLER:case STRUCTURE_EXTENSION:case STRUCTURE_KEEPER_LAIR:case STRUCTURE_LINK:case STRUCTURE_PORTAL:case STRUCTURE_WALL:case STRUCTURE_STORAGE:return!0;case STRUCTURE_RAMPART:if(e[r].structure.my===!1)return!0;break;case STRUCTURE_ROAD:break;default:throw Error("hasWall: Unknown structure type "+e[r].structure.structureType)}}return!1}RoomPosition.prototype.countEmptyTilesAround=function(){if(!(this.x<0||this.x>49||this.y<0||this.y>49)){var e=Game.rooms[this.roomName].lookAtArea(this.y-1,this.x-1,this.y+1,this.x+1),o=0;return"object"!=typeof e[this.y-1]&&(e[this.y-1]={}),"object"!=typeof e[this.y+1]&&(e[this.y+1]={}),r(e[this.y-1][this.x-1])||o++,r(e[this.y-1][this.x])||o++,r(e[this.y-1][this.x+1])||o++,r(e[this.y][this.x-1])||o++,r(e[this.y][this.x+1])||o++,r(e[this.y+1][this.x-1])||o++,r(e[this.y+1][this.x])||o++,r(e[this.y+1][this.x+1])||o++,o}}}.call(this,cachedModules[3837],cachedModules[3837].exports),cachedModules[8501]={exports:{}},function(e,o){}.call(this,cachedModules[8501],cachedModules[8501].exports),cachedModules[4327]={exports:{}},function(e,o){"use strict";cachedModules[6031].exports,cachedModules[6988].exports,cachedModules[6860].exports,cachedModules[3837].exports,cachedModules[8501].exports}.call(this,cachedModules[4327],cachedModules[4327].exports),cachedModules[260]={exports:{}},function(e,o){"use strict";e.exports=function(){return{DEBUG:!1,ROLES:[ROLE_BASE,ROLE_DUMMY,ROLE_HARVESTER,ROLE_BUILDER,ROLE_GUARD,ROLE_RANGED,ROLE_HELPER,ROLE_SCOUT]}}()}.call(this,cachedModules[260],cachedModules[260].exports),cachedModules[1815]={exports:{}},function(e,o){"use strict";function r(){for(var e in Memory.creeps)if(c.recycleCreep(e))t();else{var o=Game.creeps[e];o.action()}}function t(){var e=0;for(var o in n.ROLES)a(Game.rooms,o,!0),e+=Memory.counters[o];Memory.counters.ALIVE=e}function s(e,o,r){var t=_.pick(Memory.creeps,function(t,s){var a=Game.creeps[s];return a.memory.role==o&&-1!=_.indexOf(e,a.room.name)&&a.my==r&&!a.spawning});return t}function a(e,o,r){var t=_.map(e,function(e){return e.name}),a=_.size(s(t,o,r));void 0===Memory.counters[o]&&(Memory.counters[o]=0),Memory.counters[o]=a}var c=(cachedModules[1341].exports,cachedModules[856].exports),n=cachedModules[260].exports;e.exports={step:r}}.call(this,cachedModules[1815],cachedModules[1815].exports),cachedModules[4105]={exports:{}},function(e,o){"use strict";function r(e){var o=Game.getUsedCpu(),r=e||{};return r.CPU=o,r}function t(e){a.step();var o=e||{};return o}function s(e){var o=(Game.getUsedCpu()-e.CPU,e||{});return o}var a=(cachedModules[1341].exports,cachedModules[1815].exports);e.exports={preStep:r,step:t,postStep:s}}.call(this,cachedModules[4105],cachedModules[4105].exports),cachedModules[8448]={exports:{}},function(e,o){"use strict";function r(){t(),c.stepGlobal(),a.stepGlobal()}function t(){c.init()||i.log("╔════════════════════════╗\n║   ♫♪ ► Starting ◄ ♪♫   ║\n║         v."+AI_VERSION+"        ║\n╚════════════════════════╝ ")}function s(){var e=a.step(),o=n.preStep(e),r=n.step(o);n.postStep(r)}var a=cachedModules[7985].exports,c=cachedModules[856].exports,n=cachedModules[4105].exports,i=cachedModules[1341].exports;e.exports={globalStep:r,gameStep:s}}.call(this,cachedModules[8448],cachedModules[8448].exports);var api=cachedModules[4327].exports,gameControl=cachedModules[8448].exports,utils=cachedModules[1341].exports;gameControl.globalStep(),module.exports.loop=function(){var e=Game.getUsedCpu();gameControl.gameStep();var o=Game.getUsedCpu()-e;o&&utils.log("Game has used "+o+" CPU time")};